(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f366ac5a"],{"159b":function(t,e,a){var i=a("da84"),s=a("fdbc"),n=a("785a"),r=a("17c2"),l=a("9112"),c=function(t){if(t&&t.forEach!==r)try{l(t,"forEach",r)}catch(e){t.forEach=r}};for(var o in s)s[o]&&c(i[o]&&i[o].prototype);c(n)},"17c2":function(t,e,a){"use strict";var i=a("b727").forEach,s=a("a640"),n=s("forEach");t.exports=n?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},"206f":function(t,e,a){},5530:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("b64b"),a("a4d3"),a("4de4"),a("e439"),a("159b"),a("dbb4");var i=a("ade3");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}},"5d57":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"position-relative"},[a("span",{staticClass:"email-status"},[t.contact.email?a("span",[a("span",{ref:"email_status"},[a("a",{staticClass:"text-link",class:t.email_cls,attrs:{href:"mailto:"+t.contact.email,target:"_top"}},[t._v(t._s(t.contact.email))]),a("b-badge",{staticClass:"badge-dot ml-1",attrs:{pill:"",variant:t.email_status_type}},[t._v("Â ")])],1),t.is_unsubscribed?[a("b-tooltip",{attrs:{target:function(){return t.$refs["email_status"]},placement:t.email_tooltip_position}},[t._v(" The email address is unsubscribed and further emails are prohibited. ")])]:[a("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"flaticon-email text-primary cursor-pointer ml-2",attrs:{title:t.$t("tooltip.ai.create_email")},on:{click:t.start_email_ai}}),a("copy-btn",{staticClass:"ml-2",attrs:{text:t.contact.email},on:{"update:text":function(e){return t.$set(t.contact,"email",e)}}}),a("refresh-btn",{staticClass:"ml-2",attrs:{tooltip_msg:"Update the email and profile information",on_click:t.update_email}}),a("b-tooltip",{attrs:{target:function(){return t.$refs["email_status"]},boundary:"viewport","custom-class":"email-tooltip",placement:t.email_tooltip_position}},[t.email_in_tooltip?a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.contact.email)+": ")]):t._e(),t._v(" "+t._s(t.email_status_tooltip)+" "),a("a",{staticClass:"verify-email-by-bounceban",attrs:{href:t.verify_by_bounceban_url,target:"_blank"}},[t._v("Verify again")]),t.email_type_name?a("div",[t._v(" This is a "+t._s(t.email_type_name)+". You can disable returning emails like this "),t.config.is_plugin_app?a("b-link",{attrs:{href:"/app/email-types",target:"_blank"}},[t._v("here")]):a("router-link",{attrs:{to:{name:"email_types"}}},[t._v("here")]),t._v(". ")],1):t._e()])]],2):a("span",["skipped"===t.contact.email_status.value?a("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mr-2 text-mute",attrs:{title:t.$t("tooltip.email_status_skipped")}},[t._v(" Skipped [?] ")]):t.contact.email_status.text?a("span",{staticClass:"mr-2 text-mute"},[t._v(t._s(t.contact.email_status.text))]):t._e(),t.show_get_email_btn?a("promise-btn",{staticClass:"mr-2",attrs:{loading:t.is_finding,text:"Get email",size:"sm",variant:"outline-primary",on_click:t.update_email}}):t._e(),t.show_get_email_btn?a("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"flaticon-email text-primary cursor-pointer ml-2",attrs:{html:t.$t("tooltip.ai.create_email")},on:{click:t.write_email}}):t._e()],1)]),t.show_email_msg?[a("span",{class:t.internal_email_msg_class},[t._v(t._s(t.email_msg))])]:t._e(),t.user.is_superuser?a("a",{staticClass:"ml-2 text-link",attrs:{href:"/admin/devops/logs?track_id=contact_"+t.contact.id,target:"_blank"}},[t._v("Logs")]):t._e()],2)},s=[],n=a("5530"),r=a("1da1"),l=(a("caad"),a("2532"),a("a15b"),a("99af"),a("96cf"),a("2f62")),c=a("c1df"),o={props:{email_cls:{type:String,default:""},email_in_tooltip:{type:Boolean,default:!1},on_email_msg_change:{type:Function,default:null},on_email_ai_click:{type:Function,default:null},email_tooltip_position:{type:String,default:"top"},email_update_msg_position:{type:String,default:"right"},contact:{type:Object,default:{email:null,email_status:{},find_status:{}}}},watch:{email_msg:{handler:function(){this.on_email_msg_change&&this.on_email_msg_change({msg:this.email_msg,classes:this.email_msg_class})},immediate:!0}},mounted:function(){var t=this;this.$globalEvent.$on("GlobalEvent:EmailAI:email:sent",this.on_email_sent),this.$globalEvent.$on("GlobalEvent:EmailAI:writing_status",this.on_email_ai_writing_status),this.$once("hook:destroyed",(function(){t.$globalEvent.$off("GlobalEvent:EmailAI:email:sent",t.on_email_sent),t.$globalEvent.$off("GlobalEvent:EmailAI:writing_status",t.on_email_ai_writing_status)}))},data:function(){return{email_update_msg_contact_id:null,email_update_msg:"",is_finding:!1}},methods:{start_email_ai:function(){if(this.on_email_ai_click&&"function"===typeof this.on_email_ai_click)this.on_email_ai_click({contact_id:this.contact.id});else{this.$bvModal.hide("contact_detail_modal");var t=this.email_ai.preview_email_id;this.$globalEvent.$emit("GlobalEvent:Modal:email_ai",{contact_id:this.contact.id,preview_email_id:t})}},update_email:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.do_update_email(!1);case 2:case"end":return e.stop()}}),e)})))()},write_email:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.start_email_ai();case 1:case"end":return e.stop()}}),e)})))()},on_email_sent:function(t){var e=t.contact_id,a=t.email_id,i=t.sent_at;if(e===this.contact.id){var s={},n=this.contact.EmailAiContacts;Array.isArray(n)&&n.length&&(s=n[0]),Object.assign(s,{latest_sent_email_id:a,latest_email_sent_at:i}),Object.assign(this.contact,{EmailAiContacts:[s]})}},on_email_ai_writing_status:function(t){var e=t.contact_id,a=t.status,i=t.email_id;if(e===this.contact.id){var s={},n=this.contact.EmailAiContacts;Array.isArray(n)&&n.length&&(s=n[0]),Object.assign(s,{status:a,latest_email_id:i}),Object.assign(this.contact,{EmailAiContacts:[s]})}},do_update_email:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,s,n,l,c,o,_,u,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=e.contact.email,n=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r,l,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=1;case 1:if(!(a<=15)){t.next=24;break}return t.next=4,e.$utils.sleep(5e3);case 4:return t.prev=4,t.next=7,e.$api.req({url:"/api/find/email/status",method:"GET",params:{contact_id:e.contact.id}},!0,!0);case 7:if(i=t.sent,n=i.is_finding,r=i.contact,s=r,!0===n){t.next=13;break}return t.abrupt("break",24);case 13:t.next=21;break;case 15:if(t.prev=15,t.t0=t["catch"](4),l=t.t0.status,c=t.t0.message,o=t.t0.error_shown,504===l){t.next=21;break}return o||e.$utils.showMessage(c||e.$t("error.failed_request"),"error"),t.abrupt("break",24);case 21:a++,t.next=1;break;case 24:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(){return t.apply(this,arguments)}}(),a.prev=2,a.next=5,e.$api.req({url:"/api/contact/email/update",method:"POST",data:{contact_id:e.contact.id,is_write_email:!0===t}},!0);case 5:if(l=a.sent,c=l.timeout,o=l.contact,!0===t&&e.start_email_ai(),s=o,!0!==c){a.next=13;break}return a.next=13,n();case 13:a.next=24;break;case 15:if(a.prev=15,a.t0=a["catch"](2),_=a.t0.status,u=a.t0.message,504!==_){a.next=23;break}return a.next=21,n();case 21:a.next=24;break;case 23:[403].includes(_)||e.$utils.showMessage(u||e.$t("error.failed_request"),"error");case 24:if(s){a.next=27;break}return e.email_update_msg="No new email is found.",a.abrupt("return");case 27:e.$globalEvent.$emit("GlobalEvent:Contact:updated",{contact:s}),e.email_update_msg_contact_id=s.id,m=function(){if(i)return s.email&&s.email!==i?void(e.email_update_msg="Email is updated."):void(e.email_update_msg="No new email is found.");s.email?e.email_update_msg="Email is updated.":e.email_update_msg="No new email is found."},m();case 31:case"end":return a.stop()}}),a,null,[[2,15]])})))()}},computed:Object(n["a"])(Object(n["a"])({},Object(l["d"])({user:function(t){return t.global.user},config:function(t){return t.global.config}})),{},{show_get_email_btn:function(){return!this.contact||!this.contact.email&&(!this.contact.find_status||![7,10].includes(this.contact.find_status.value))},email_ai:function(){var t,e,a,i,s=this.contact,n=s.EmailAiContacts,r=s.EmailAITasks;if(!Array.isArray(n)||0===n.length)return{has_email_ai:!1};var l=!1,c=n[0],o=c.latest_email_sent_at,_=c.latest_email_id,u=c.latest_sent_email_id,m=c.status,p=m||{},d=p.value,f=this.$utils.AI_Contact_Status;if(l=[f.WRITING.value,f.TASK_WRITING.value].includes(d),t=u,e=o,a=_,Array.isArray(r)&&r.length>0){var h=r[0].Relation.email_id;i=h}var g=e,b=parseInt(u)||0,v=parseInt(_)||0;u&&_&&v>b&&(g=null);var w={has_email_ai:!0,is_writing:l,latest_email_sent_at:g,latest_email_id:a,latest_sent_email_id:t,preview_email_id:i||a||t};return w},internal_email_msg_class:function(){var t=this.email_msg_class;return"bottom"===this.email_update_msg_position?t.push("update-msg"):t.push("ml-2"),t.join(" ")},email_msg_class:function(){var t=[],e=this.get_email_update_msg,a=this.email_ai,i=a.has_email_ai,s=a.is_writing,n=a.latest_email_sent_at,r=(a.latest_sent_email_id,a.latest_email_id);return e?t.push("text-mute"):i&&(s?t.push("text-primary"):n?t.push("text-success"):r?t.push("text-warning"):t.push("text-danger")),t},email_msg:function(){var t=this.get_email_update_msg;if(t)return t;var e=this.email_ai,a=e.has_email_ai,i=e.latest_email_sent_at,s=e.latest_email_id,n=e.is_writing;return a?n?this.$t("message.ai.email_status.writing"):i?"".concat(this.$t("message.ai.email_status.sent")).concat(c(i).format("MMM D HH:mm:ss")):s?this.$t("message.ai.email_status.draft_ready"):this.$t("message.ai.email_status.written_error"):""},get_email_update_msg:function(){return this.email_update_msg_contact_id?this.contact.id!==this.email_update_msg_contact_id?"":this.email_update_msg:""},is_generic_email:function(){var t=this.contact.email_type||{},e=t.value;return 5===e},is_personal_email:function(){var t=this.contact.email_type||{},e=t.value;return 7===e},email_type_name:function(){return this.is_personal_email?"personal email":this.is_generic_email?"generic email":""},is_unsubscribed:function(){var t=this.contact.privacy||{},e=t.value,a=this.$utils.CONTACT_PRIVACY.REQUESTED_REMOVAL;return e===a},show_email_msg:function(){return!this.is_unsubscribed&&!this.on_email_msg_change},email_status_type:function(){return this.is_unsubscribed?"danger":"valid"===this.contact.email_status.value?"success":"invalid"===this.contact.email_status.value?"danger":"warning"},email_status_tooltip:function(){var t=this.contact,e=t.email_status,a=t.email_validate_time,i=[];return"valid"===e.value?i.push("Valid and safe for sending."):"invalid"===e.value?i.push("The email is invalid and NOT safe for sending."):i.push("This is a risky email and it's risky for sending."),a&&i.push("Verified at: ".concat(c(a).format("YYYY-MM-DD"),".")),i.join(" ")},verify_by_bounceban_url:function(){return"https://bounceban.com/app/verify?email=".concat(this.contact.email,"&source=finalscout")}})},_=o,u=(a("8eeb"),a("2877")),m=Object(u["a"])(_,i,s,!1,null,null,null);e["default"]=m.exports},"8eeb":function(t,e,a){"use strict";a("206f")},ade3:function(t,e,a){"use strict";function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,"a",(function(){return i}))},dbb4:function(t,e,a){var i=a("23e7"),s=a("83ab"),n=a("56ef"),r=a("fc6a"),l=a("06cf"),c=a("8418");i({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(t){var e,a,i=r(t),s=l.f,o=n(i),_={},u=0;while(o.length>u)a=s(i,e=o[u++]),void 0!==a&&c(_,e,a);return _}})},e439:function(t,e,a){var i=a("23e7"),s=a("d039"),n=a("fc6a"),r=a("06cf").f,l=a("83ab"),c=s((function(){r(1)})),o=!l||c;i({target:"Object",stat:!0,forced:o,sham:!l},{getOwnPropertyDescriptor:function(t,e){return r(n(t),e)}})}}]);